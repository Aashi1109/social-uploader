# Social Uploader (MVP)\n\nBackend to publish media to multiple platforms via webhook. Express + BullMQ, Postgres, local AES secrets, Pino, Prometheus.\n\n## Quick start\n1. Set env vars (example below). Use external Postgres + Redis.\n2. Install deps: `pnpm install`\n3. Generate Prisma client: `pnpm prisma:generate`\n4. Apply migrations: `pnpm migrate` (requires DATABASE_URL)\n5. Dev: `pnpm dev:all` (API on :3000)\n\n## Env\n- API_TOKEN or API_TOKENS\n- DATABASE_URL\n- REDIS_URL\n- MASTER_KEY (64 hex chars)\n- PORT (default 3000)\n\n## Webhook\nPOST /v1/publish (Bearer auth)\n```\n{\n  \"projectId\": \"default\",\n  \"mediaUrl\": \"https://.../video.mp4\",\n  \"idempotencyKey\": \"abc-123\",\n  \"title\": \"Hello\",\n  \"description\": \"World\",\n  \"platforms\": [\"instagram\", \"youtube\"]\n}\n```\nResponse: `{ \"requestId\": \"...\" }`\n\nGET /v1/publish/:id returns timeline.\n\n## Idempotency\nUniq on (projectId, idempotencyKey). Same payload with same key returns original requestId.\n\n## Secrets\nLocal AES-256-GCM. Rotate by writing a new Secret row (higher version) with `MASTER_KEY`-encrypted payload.\n\n## Rate limiting\n30 req/min per IP on POST /v1/publish.\n\n## E2E smoke\nSee `scripts/smoke.sh` for example curl commands.\n\n```bash\n# prerequisites: DATABASE_URL, REDIS_URL, API_TOKEN, MASTER_KEY\npnpm prisma:generate && pnpm migrate\npnpm dev:all &\n./scripts/smoke.sh\n```\n\n## Migrations\nThe initial SQL is in prisma/migrations/20251108_init/migration.sql. Apply with `pnpm migrate`.\n*** End Patch  \n```" }```  software error.  Let's retry with correct FREEFORM content.  -->

